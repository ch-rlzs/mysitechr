<script>
    // Human-like typing animation
    const bootMessages = [
      "Initializing system...",
      "Checking security protocols...",
      "Establishing secure connection...",
      "Loading directory structure...",
      "System ready."
    ];

    const bootSequence = document.getElementById('boot-sequence');
    const directoryView = document.getElementById('directory-view');
    const commandLine = document.getElementById('command-line');

    async function humanType(text, element) {
      return new Promise(async (resolve) => {
        let currentText = element.innerHTML.replace(/<span class="typing-cursor"><\/span>/g, '');
        element.innerHTML = currentText + `<span class="typing-cursor"></span>`;
        
        // Random typing speed variation (80-150ms)
        const baseSpeed = 80 + Math.random() * 70;
        
        // Sometimes make a "mistake" and correct it (20% chance for longer words)
        let willMakeMistake = text.length > 8 && Math.random() < 0.2;
        let mistakeIndex = willMakeMistake ? Math.floor(text.length * 0.7) : -1;
        let mistakeCorrected = false;
        
        for (let i = 0; i < text.length; i++) {
          // Random slight speed variation for each character
          const charSpeed = baseSpeed * (0.8 + Math.random() * 0.4);
          
          // Pause slightly longer at certain characters
          const pauseMultiplier = ['.', ',', ' ', ':'].includes(text[i]) ? 2.5 : 1;
          
          await new Promise(r => setTimeout(r, charSpeed * pauseMultiplier));
          
          // Make a "typing mistake" (type wrong character then correct)
          if (willMakeMistake && i >= mistakeIndex && !mistakeCorrected) {
            const wrongChar = String.fromCharCode(text.charCodeAt(i) + 1);
            currentText = currentText + wrongChar;
            element.innerHTML = currentText + `<span class="typing-cursor"></span>`;
            
            // Pause briefly on the mistake
            await new Promise(r => setTimeout(r, baseSpeed * 3));
            
            // Backspace and type correct character
            currentText = currentText.slice(0, -1);
            element.innerHTML = currentText + `<span class="typing-cursor"></span>`;
            await new Promise(r => setTimeout(r, baseSpeed * 0.7));
            
            mistakeCorrected = true;
          }
          
          currentText = currentText + text[i];
          element.innerHTML = currentText + `<span class="typing-cursor"></span>`;
        }
        
        // Final pause at end of line (longer for some lines)
        const endPause = text.endsWith('...') ? 500 : 200;
        await new Promise(r => setTimeout(r, endPause));
        
        element.innerHTML = currentText + `<br>`;
        resolve();
      });
    }

    async function runBootSequence() {
      bootSequence.innerHTML = `<span class="typing-cursor"></span>`;
      
      for (const message of bootMessages) {
        await humanType(message, bootSequence);
        
        // Random pause between lines (100-400ms)
        await new Promise(r => setTimeout(r, 100 + Math.random() * 300));
      }
      
      // Show the terminal interface after boot sequence
      bootSequence.style.display = 'none';
      directoryView.style.display = 'block';
      commandLine.style.display = 'flex';
      
      // Focus the input
      document.getElementById('inputPrompt').focus();
    }

    // Start the boot sequence when page loads
    document.addEventListener('DOMContentLoaded', runBootSequence);
</script>
